<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>USD to MXN Converter</title>
    <style>
      body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    background-color: #f4f4f4;
    font-size: 1rem; /* base font size */
}

h2 {
    font-size: 2rem; /* scales better on smaller screens */
    text-align: center;
    margin: 0 0 1rem 0;
    width: 100%;
}

.converter {
    background: #fff;
    padding: 2rem;
    border-radius: 1rem;
    box-shadow: 0 0 1rem rgba(0, 0, 0, 0.1);
    text-align: left;
    width: 90vw;
    max-width: 25rem; /* constrains the width on larger screens */
}

label {
    font-size: 1.25rem;
    display: block;
    margin-bottom: 0.5rem;
}

input[type="text"],
input[type="number"] {
    padding: 0.5rem;
    width: 100%;
    margin-bottom: 1rem;
    border: 0.125rem solid #ccc;
    border-radius: 0.25rem;
    font-size: 1.5rem;
    display: block;
}

p[id="result"] {
    margin-top: 1rem;
    font-size: 1.75rem;
}

p[id="rate-visual"] {
    font-size: 1.5rem;
    margin-bottom: 0;
}

p[id="updated"] {
    font-size: 1rem;
    margin-top: 0;
}

button {
    padding: 0.5rem;
    background: #28a745;
    color: white;
    border: none;
    border-radius: 0.25rem;
    font-size: 1.5rem;
    cursor: pointer;
    width: 100%;
}

button:hover {
    background: #218838;
}

p {
    font-size: 1.5rem;
    margin-top: 1rem;
    text-align: center;
}

/* Responsive adjustments */
@media (min-width: 768px) {
    h2 {
        font-size: 2.5rem; /* slightly larger on tablets */
    }

    .converter {
        width: 60vw;
        max-width: 30rem;
    }
}

@media (min-width: 1024px) {
    h2 {
        font-size: 3rem; /* larger heading for desktops */
    }

    .converter {
        width: 50vw;
        max-width: 35rem;
    }
}

    </style>
  </head>
  <body>
    <div class="converter">
      <h2>USD to MXN Converter</h2>
      <label for="amount">Amount in USD</label>
      <input type="text" id="amount" placeholder="Enter amount in USD">
      <label for="rate">Conversion Rate ($1 MXN to USD)</label>
      <input type="number" id="rate" step="0.0001">
      <button onclick="convertCurrency()">Convert</button>
      <p id="result" style="color: green;">$0.00 MXN = $0.00 USD</p>
      <p id="rate-visual">
      <p>
        <button onclick="fetchConversionRate()">Update Rate</button>
      <p id="updated"></p>
		<button onclick="window.location.href='conversion-mxn-to-usd.html';">MXN to USD</button>
    </div>
    <script>
      let markup = 0.0;
      let conversionRate = 0;
      // Fetch the latest conversion rate from the API
      async function fetchConversionRate() {
        try {
          const response = await fetch('https://openexchangerates.org/api/latest.json?app_id=113d7827d40d485bb66a483a3267dc3e');
          const data = await response.json();
          conversionRate = (1 / (data.rates.MXN + (data.rates.MXN * markup))).toFixed(10);
          const unixTimestamp = data.timestamp;
          const updated = new Date(unixTimestamp * 1000);
          // Set the value of the rate input to the fetched conversion rate
          document.getElementById('rate').value = conversionRate;
          const formattedDate = `${updated.getMonth() + 1}/${updated.getDate()}/${updated.getFullYear()} ${formatAMPM(updated)}`;
          document.getElementById('rate-visual').innerText = `Current Rate: $1 MXN = $${conversionRate} USD`;
          document.getElementById('updated').innerText = `Last Update: ${formattedDate}`;
        } catch (error) {
          console.error(`Error fetching the conversion rate:`, error);
          document.getElementById('updated').innerText = `Failed to fetch conversion rate.`;
        }
      }

      function convertCurrency() {
        const amount = parseFloat(document.getElementById('amount').value.replace(/[^0-9.]/g, ''));
        const rate = parseFloat(document.getElementById('rate').value);
        if (isNaN(amount) || amount <= 0) {
          document.getElementById('result').innerText = "Please enter a valid amount.";
          return;
        }
        if (isNaN(rate) || rate <= 0) {
          document.getElementById('result').innerText = "Please enter a valid conversion rate.";
          return;
        }
        const result = (amount / rate).toLocaleString('en-US', {
          style: 'currency',
          currency: 'USD'
        });
        const formattedAmount = amount.toLocaleString('en-US', {
          style: 'currency',
          currency: 'USD'
        });
        document.getElementById('result').innerText = `${result} MXN = ${formattedAmount} USD`;
      }

      function formatAMPM(date) {
        var hours = date.getHours();
        var minutes = date.getMinutes();
        var ampm = hours >= 12 ? 'PM' : 'AM';
        hours = hours % 12;
        hours = hours ? hours : 12; // the hour '0' should be '12'
        minutes = minutes < 10 ? '0' + minutes : minutes;
        var strTime = hours + ':' + minutes + ' ' + ampm;
        return strTime;
      }
      // Fetch the conversion rate when the page loads
      window.onload = fetchConversionRate;
    </script>
  </body>
</html>